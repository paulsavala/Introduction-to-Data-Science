
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Working with large datasets &#8212; Introduction to Data Science</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Ensemble tree models" href="ch_10.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Introduction to Data Science</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ch_01.html">
   First steps with Pandas and Jupyter notebooks
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="ch_02.html">
   Plotting and grouping data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_03.html">
   Correlation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_04.html">
   Linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_05.html">
   Training models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_06.html">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_07.html">
   Nearest neighbors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_08.html">
   Decision Trees
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_09.html">
   Improving your model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch_10.html">
   Ensemble tree models
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Working with large datasets
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ch_11.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/ch_11.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understanding-memory-usage-a-id-understanding-memory-a">
   Understanding memory usage
   <a id="understanding_memory">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selectively-loading-data-a-id-selective-loading-a">
   Selectively loading data
   <a id="selective_loading">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loading-only-a-subset-of-your-data-a-id-loading-subset-a">
     Loading only a subset of your data
     <a id="loading_subset">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-data-types-upon-loading-a-id-loading-dtypes-a">
     Setting data types upon loading
     <a id="loading_dtypes">
     </a>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#timing-computations-a-id-timing-computations-a">
   Timing computations
   <a id="timing_computations">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#comprehensions-a-id-comprehensions-a">
   Comprehensions
   <a id="comprehensions">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deleting-data-in-memory">
   Deleting data in-memory
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sklearn-warm-start-a-id-warm-start-a">
   Sklearn warm start
   <a id="warm_start">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#final-thoughts-a-id-final-thoughts-a">
   Final thoughts
   <a id="final_thoughts">
   </a>
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="working-with-large-datasets">
<h1>Working with large datasets<a class="headerlink" href="#working-with-large-datasets" title="Permalink to this headline">¶</a></h1>
<p>Prior to this course, if you had never done any data analysis you probably had never worked with more than a few hundred rows of data in Excel. Even if you did have experience with data analysis, it’s likely that you had never worked with more than tens or hundreds of thousands of rows of data. However, modern companies often work with millions or billions of rows of data. Simply taking the things we’ve done up to this point in this course and applying them to large datasets will not work. This week we’ll see why, and learn some ways to understand and work with large datasets.</p>
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="understanding-memory-usage-a-id-understanding-memory-a">
<h2>Understanding memory usage <a id="understanding_memory"></a><a class="headerlink" href="#understanding-memory-usage-a-id-understanding-memory-a" title="Permalink to this headline">¶</a></h2>
<p>Anything you run on a computer is limited by two things: processing power (how quickly your computer can perform calculations) and memory (how much data your computer can hold). Each of these two components also have two places where they happen:</p>
<ul class="simple">
<li><p>Processing</p>
<ul>
<li><p><strong>CPU:</strong> (Central Processing Unit) The main processor your computer uses to run pretty much all calculations</p></li>
<li><p><strong>GPU:</strong> (Graphic Processing Unit) A separate component which some (but not all) computers have. These are optimized to perform matrix multiplication.</p></li>
</ul>
</li>
<li><p>Memory</p>
<ul>
<li><p><strong>HDD:</strong> (Hard Disk Drive) The main place your computer stores your programs and files. When your phone tells you “you are running out of memory”, they are referring to your HDD, or “hard drive” for short.</p></li>
<li><p><strong>RAM:</strong> (Random Access Memory) A much faster form of storage than your HDD. This is used to store data which will only be needed for a short period of time. For example, if you take a picture on your phone it stores it on the hard drive. However, if you want to apply some filters and post it on Instagram, your computer will copy it to RAM. While in RAM, it is much faster to manipulate it (e.g. apply filters to, crop, etc.) than if it were working with the copy on your hard drive.</p></li>
</ul>
</li>
</ul>
<p>In this course we won’t deal with GPUs. However, modern deep learning involving neural networks rely heavily on GPUs, since neural networks primarily involve matrix operations. The machine learning we’ve done in this class wouldn’t be faster on a GPU, because we aren’t working with matrices. Therefore, we won’t worry about the processing component. Memory, on the other hand, is a major factor with every machine learning project, no matter if it’s using decision trees, neural networks, or just linear regression.</p>
<p>Thus far, the datasets we’ve worked with are fairly small. But before we get ahead of ourselves, how do we even measure “small” vs “big”? Your first guess is probably the number of rows. However, rows and columns are the same thing, so one million rows and ten columns is the same as ten rows and one million columns. However, even if two datasets have the same number of rows and columns, they can still be drastically different sizes. In fact, if two people are given the <em>exact same dataset</em>, depending on how they load them into Pandas one can easily be <em>ten times</em> the size of another! Let’s load the free throws NBA data to see this in action.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>1</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>2</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>0</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Shawn Marion</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>21</td>
      <td>114</td>
      <td>106</td>
      <td>29.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Rows = </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">Columns = </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">Total cells = </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows = 618019
Columns = 13
Total cells = 8034247
</pre></div>
</div>
</div>
</div>
<p>In order to see how much memory some data is using, you can use the Pandas method <code class="docutils literal notranslate"><span class="pre">.memory_usage()</span></code>. This will return the memory usage in bytes (explained below).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index                    128
period               4944152
player               4944152
playoffs             4944152
shot_made            4944152
home_team            4944152
visit_team           4944152
home_score           4944152
visit_score          4944152
home_final_score     4944152
visit_final_score    4944152
minutes              4944152
season_start         4944152
shot_count           4944152
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>As you’ve likely at least heard, computers store all information in binary (except quantum computers!). That is, everything is stored as a <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>. A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> is referred to as a <strong>bit</strong>. A <strong>byte</strong> (pronounced “bite”) is eight bits. So, since a single bit has 2 possible outcomes, a byte has <span class="math notranslate nohighlight">\(2^8 = 256\)</span> possible values. Historically every single number, character or punctuation mark on a computer could be stored with one byte (<a class="reference external" href="https://www.commfront.com/pages/ascii-chart">here</a> is a chart showing how every possible value was stored). Therefore, a byte is considered to be a fundamental unit of memory measurement. While bits are smaller and make up bytes, people today primarily work directly with bytes (in the same way as scientists typically work with molecules, cells, etc., as opposed to directly counting the number of protons, neutrons and electrons). Bytes are very small, and most modern data/programs is instead measured in larger measurements. The next largest measurement is a “kilobyte”. A <strong>kilobyte</strong> is one thousand bytes. Next we have a “megabyte”. Historically, a <strong>megabyte</strong> was <span class="math notranslate nohighlight">\(2^{20} = 1,048,576\)</span> bytes. However, in modern times we simply call a megabyte one million bytes (hence the prefix “mega”, which means “million”), or <span class="math notranslate nohighlight">\(10^6\)</span>. Thus a megabyte can store one million characters (ornumbers, or punctations, etc.). Next up is gigabytes. A <strong>gigabyte</strong> historically was <span class="math notranslate nohighlight">\(2^{30} = 1,073,741,824\)</span> bytes, however we now round that to one billion bytes, or <span class="math notranslate nohighlight">\(10^9\)</span>. Measurements certainly go higher, but we’ll stop there for now.</p>
<p>As mentioned above, Pandas <code class="docutils literal notranslate"><span class="pre">.memory_usage()</span></code> displays the value in bytes. This is too small of a measurement. Let’s convert it to megabytes by dividing by <span class="math notranslate nohighlight">\(10^6\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index                0.000128
period               4.944152
player               4.944152
playoffs             4.944152
shot_made            4.944152
home_team            4.944152
visit_team           4.944152
home_score           4.944152
visit_score          4.944152
home_final_score     4.944152
visit_final_score    4.944152
minutes              4.944152
season_start         4.944152
shot_count           4.944152
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>So each column (besides the index) is using about 5 megabytes (or MB, for short). To find out the <em>total</em> memory usage, just sum these up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64.27410400000001
</pre></div>
</div>
</div>
</div>
<p>So about 64 MB in total. Let’s look at the data types of each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>period                 int64
player                object
playoffs               int64
shot_made              int64
home_team             object
visit_team            object
home_score             int64
visit_score            int64
home_final_score       int64
visit_final_score      int64
minutes              float64
season_start           int64
shot_count             int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We see that there are a mixture of integers, strings (objects) and floats. One component we never discussed was the “64” after <code class="docutils literal notranslate"><span class="pre">int</span></code> and <code class="docutils literal notranslate"><span class="pre">float</span></code>. This means that the computer can store <span class="math notranslate nohighlight">\(2^{64}\)</span> values of that type. Since we potentially have both positive and negative values, this means that <code class="docutils literal notranslate"><span class="pre">int64</span></code> can store values from <span class="math notranslate nohighlight">\(-2^{32}\)</span> to <span class="math notranslate nohighlight">\(2^{32}\)</span>, or values in the range <span class="math notranslate nohighlight">\((-4294967296, 4294967295)\)</span>. Why does that matter? Because Pandas doesn’t know if you any number you put in will actually <em>need</em> to be that big or not. Therefore, it <em>allocates</em> (sets aside) that much space for every cell in your data. Is that necessary? After all, the <code class="docutils literal notranslate"><span class="pre">shot_made</span></code> column only has a value of 0 or 1!</p>
<p>A very powerful technique is to <strong>downcast</strong> your data by storing it in the smallest possible data type you can. In the background, Pandas is actually using numpy to store all data, so we’re really interested in the numpy data types. <a class="reference external" href="https://numpy.org/devdocs/user/basics.types.html">Here is a list</a> of all numpy data types. Take a moment and find the integers on that chart. You will see that there are several different data types to store integers. We will focus on the following ones:</p>
<ul class="simple">
<li><p>np.int8: (-128 to 127)</p></li>
<li><p>np.int16: (-32768 to 32767)</p></li>
<li><p>np.int32 (-2147483648 to 2147483647)</p></li>
<li><p>np.int64: (-9223372036854775808 to 9223372036854775807)</p></li>
<li><p>np.uint8: (0 to 255)</p></li>
<li><p>np.uint16: (0 to 65535)</p></li>
<li><p>np.uint32: (0 to 4294967295)</p></li>
<li><p>np.uint64: (0 to 18446744073709551615)</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">u</span></code> in front of some of these refers to “unsigned” which means it is positive (because you don’t need a “sign” to represent it). As you might guess, data types for smaller numbers take up less space in memory. Let’s start with the <code class="docutils literal notranslate"><span class="pre">period</span></code> column, which is currently stored as <code class="docutils literal notranslate"><span class="pre">int64</span></code> (see the results of <code class="docutils literal notranslate"><span class="pre">df.dtypes</span></code> above). Let’s check what values actually appear in that column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2, 3, 4, 5, 6, 7, 8])
</pre></div>
</div>
</div>
</div>
<p>Only 1 through 8. Therefore, it’s positive and small, and so we can store it in the smallest unsigned integer possible, namely <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>. In order to change the data type, you can use the Pandas method <code class="docutils literal notranslate"><span class="pre">.astype()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you look at the data, you’ll see that nothing has changed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>1</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>2</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>0</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Shawn Marion</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>21</td>
      <td>114</td>
      <td>106</td>
      <td>29.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>All that’s happening is that the computer is setting aside less memory to store this value. That’s because now it nows that (at worst) it will need to store a value up to 256, as opposed to 922,337,203,685,477,5807. Let’s now look at the memory usage again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index                0.000128
period               0.618019
player               4.944152
playoffs             4.944152
shot_made            4.944152
home_team            4.944152
visit_team           4.944152
home_score           4.944152
visit_score          4.944152
home_final_score     4.944152
visit_final_score    4.944152
minutes              4.944152
season_start         4.944152
shot_count           4.944152
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We see that <code class="docutils literal notranslate"><span class="pre">period</span></code> went from 4.94 MB to 0.62MB! That’s a reduction of 4.94 / 0.62 = 7.9 times! Let’s do the same for the other integer columns. The only integer column we need to be careful about is the <code class="docutils literal notranslate"><span class="pre">season_start</span></code>. Since the seasons are in the 2000’s, just representing numbers up to 256 won’t be enough. In fact, if you try to downcast it to <code class="docutils literal notranslate"><span class="pre">np.int8</span></code> you get the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;season_start&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        -42
1        -42
2        -42
3        -42
4        -42
          ..
618014   -33
618015   -33
618016   -33
618017   -33
618018   -33
Name: season_start, Length: 618019, dtype: int8
</pre></div>
</div>
</div>
</div>
<p>So we’ll put that one as <code class="docutils literal notranslate"><span class="pre">np.uint16</span></code> so that values up to 65,535 can be stored.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">small_int_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;playoffs&#39;</span><span class="p">,</span> <span class="s1">&#39;shot_made&#39;</span><span class="p">,</span> <span class="s1">&#39;home_score&#39;</span><span class="p">,</span> <span class="s1">&#39;visit_score&#39;</span><span class="p">,</span> <span class="s1">&#39;home_final_score&#39;</span><span class="p">,</span> <span class="s1">&#39;visit_final_score&#39;</span><span class="p">,</span> <span class="s1">&#39;shot_count&#39;</span><span class="p">]</span>
<span class="n">big_int_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;season_start&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">small_int_cols</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">big_int_cols</span><span class="p">:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Checking memory usage again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index                0.000128
period               0.618019
player               4.944152
playoffs             0.618019
shot_made            0.618019
home_team            4.944152
visit_team           4.944152
home_score           0.618019
visit_score          0.618019
home_final_score     0.618019
visit_final_score    0.618019
minutes              4.944152
season_start         1.236038
shot_count           0.618019
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.956926
</pre></div>
</div>
</div>
</div>
<p>Not bad! We went from about 64 MB to 26 MB, a reduction of more than half! Float and object columns (along with dates) are typically left alone. The one thing you can do is turn strings into numbers (such as by using a label encoder), which will reduce their memory usage. However, in our case that’s not worth the effort. One final note is that a way to store data which is only <code class="docutils literal notranslate"><span class="pre">1</span></code>/<code class="docutils literal notranslate"><span class="pre">0</span></code> is a boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code>). Let’s make <code class="docutils literal notranslate"><span class="pre">shot_made</span></code> be a boolean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;shot_made&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;shot_made&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index                0.000128
period               0.618019
player               4.944152
playoffs             0.618019
shot_made            0.618019
home_team            4.944152
visit_team           4.944152
home_score           0.618019
visit_score          0.618019
home_final_score     0.618019
visit_final_score    0.618019
minutes              4.944152
season_start         1.236038
shot_count           0.618019
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As you can see, this didn’t actually reduce the memory usage at all. All it did was change how it’s displayed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>True</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>1</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>True</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>2</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>True</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>False</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Shawn Marion</td>
      <td>0</td>
      <td>True</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>21</td>
      <td>114</td>
      <td>106</td>
      <td>29.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="selectively-loading-data-a-id-selective-loading-a">
<h2>Selectively loading data <a id="selective_loading"></a><a class="headerlink" href="#selectively-loading-data-a-id-selective-loading-a" title="Permalink to this headline">¶</a></h2>
<p>If you go look at the <a class="reference external" href="https://www.kaggle.com/competitions">competitions on Kaggle</a> you will see many that have datasets in the tens to hundreds of gigabytes. You may think this is not a problem, as modern computers also have hundreds of gigabytes of storage. In fact, if you were to go buy the <a class="reference external" href="https://www.apple.com/shop/buy-mac/mac-mini">cheapest computer Apple makes</a> it comes with at least 256 GB of storage, and can easily be scaled to several factors of that. However, not all storage is the same. As discussed above, there is both your hard drive (HDD) and RAM. The Mac Mini linked above has 256 GB hard drive (in fact an SSD drive, which is a faster version of a hard drive) and 8 GB of RAM.</p>
<p>When you download data (or any file) it is stored on your hard drive. However, once you start working with it in Pandas, it copies it onto your RAM. This is because RAM is much faster. Therefore, if it needs to quickly calculate things from your data, find a subset, build a model, etc., this is all much faster if it is on RAM. So while your computer may have 256 GB of storage and can easily hold a 100 GB dataset, the place where your computer <em>wants</em> to put your data (RAM) is only 8 GB.</p>
<p>Because of this, working with large datasets is extremely difficult. We saw above that one way to deal with this is to load the entire dataset and then change the data types to make it smaller. However, what if the entire data is too large to load? Or what if it’s small enough to load, but still would take up lots of memory on your computer and make everything slow? There are two ways to deal with this.</p>
<div class="section" id="loading-only-a-subset-of-your-data-a-id-loading-subset-a">
<h3>Loading only a subset of your data <a id="loading_subset"></a><a class="headerlink" href="#loading-only-a-subset-of-your-data-a-id-loading-subset-a" title="Permalink to this headline">¶</a></h3>
<p>One solution is just to load a subset of the data. For example, in the NBA data above, is it really necessary for us to have access to <em>every single free throw</em> in order to predict free throws? In fact, when we build models we typically only take 70% or so to train the model on. If you want to only load a subset of your data, you can do so using the <code class="docutils literal notranslate"><span class="pre">nrows</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">.read_csv()</span></code>. So for example, the code below loads only the first 100 rows of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>1</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>2</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>0</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Shawn Marion</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>21</td>
      <td>114</td>
      <td>106</td>
      <td>29.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100, 13)
</pre></div>
</div>
</div>
</div>
<p>This can be useful for just working with a small subset of your data, or for getting just a few rows to look at. After all, how can you you know what data types to make each column if you can’t even see the data?</p>
<p>You may be tempted to just say “if my data is big, I’ll just load 100,000 rows and use that for my training set”. The problem is that <code class="docutils literal notranslate"><span class="pre">nrows=100000</span></code> simply takes the <em>first</em> 100,000 rows. So in our NBA example, that would start with the first season. But what if things changed in later seasons? That data wouldn’t be in our training data, and thus our sample wouldn’t be very representative of the data as a whole. It is possible to tell Pandas to skip every (say) 10th row, but even then you run the risk of getting a poor sample. Therefore, it is to your advantage to simply load as much data as you can and understand your data first. Then you can decide how best to sample your data.</p>
<p>Finally, suppose you looked at the first 100,000 rows and realized that the dates are increasing. Now you want to get the next 100,000 rows so that you can get some data from later dates. How do you do this? Do you have to load 200,000 rows and just look at the last 100,000? If so, what do you do when you need rows 10,100,000 to 10,200,000? Luckily, Pandas let you <code class="docutils literal notranslate"><span class="pre">skip_rows</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load 100 rows again, but skip the first 100 so that we&#39;re starting at row 101</span>
<span class="n">df_mini2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>1</td>
      <td>Wally Szczerbiak</td>
      <td>0</td>
      <td>0</td>
      <td>BOS</td>
      <td>NO</td>
      <td>2</td>
      <td>8</td>
      <td>87</td>
      <td>91</td>
      <td>33.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>96</th>
      <td>1</td>
      <td>Desmond Mason</td>
      <td>0</td>
      <td>1</td>
      <td>BOS</td>
      <td>NO</td>
      <td>4</td>
      <td>9</td>
      <td>87</td>
      <td>91</td>
      <td>32.266667</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>97</th>
      <td>1</td>
      <td>Desmond Mason</td>
      <td>0</td>
      <td>1</td>
      <td>BOS</td>
      <td>NO</td>
      <td>4</td>
      <td>10</td>
      <td>87</td>
      <td>91</td>
      <td>32.266667</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>98</th>
      <td>1</td>
      <td>Desmond Mason</td>
      <td>0</td>
      <td>0</td>
      <td>BOS</td>
      <td>NO</td>
      <td>8</td>
      <td>10</td>
      <td>87</td>
      <td>91</td>
      <td>26.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>99</th>
      <td>1</td>
      <td>Desmond Mason</td>
      <td>0</td>
      <td>0</td>
      <td>BOS</td>
      <td>NO</td>
      <td>8</td>
      <td>10</td>
      <td>87</td>
      <td>91</td>
      <td>26.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>Desmond Mason</th>
      <th>0</th>
      <th>0.1</th>
      <th>BOS</th>
      <th>NO</th>
      <th>8</th>
      <th>10</th>
      <th>87</th>
      <th>91</th>
      <th>26.0</th>
      <th>2006</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Chris Paul</td>
      <td>0</td>
      <td>1</td>
      <td>BOS</td>
      <td>NO</td>
      <td>8</td>
      <td>11</td>
      <td>87</td>
      <td>91</td>
      <td>24.066667</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Al Jefferson</td>
      <td>0</td>
      <td>0</td>
      <td>BOS</td>
      <td>NO</td>
      <td>15</td>
      <td>21</td>
      <td>87</td>
      <td>91</td>
      <td>12.666667</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Rajon Rondo</td>
      <td>0</td>
      <td>0</td>
      <td>BOS</td>
      <td>NO</td>
      <td>15</td>
      <td>23</td>
      <td>87</td>
      <td>91</td>
      <td>5.133333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Rajon Rondo</td>
      <td>0</td>
      <td>1</td>
      <td>BOS</td>
      <td>NO</td>
      <td>16</td>
      <td>23</td>
      <td>87</td>
      <td>91</td>
      <td>5.133333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Bobby Jackson</td>
      <td>0</td>
      <td>1</td>
      <td>BOS</td>
      <td>NO</td>
      <td>16</td>
      <td>26</td>
      <td>87</td>
      <td>91</td>
      <td>2.800000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You may have noted by when we skipped rows it also skipped the headers (rows showing the column names at the top), so that our columns have names like “2006” and “BOS”. The easiest thing to do is to tell Pandas to skip from rows 1 to 100 (say).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_mini2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>2</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>0</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Shawn Marion</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>21</td>
      <td>114</td>
      <td>106</td>
      <td>29.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Amare Stoudemire</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>20</td>
      <td>33</td>
      <td>114</td>
      <td>106</td>
      <td>13.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With this, we can now do something called “chunking”. <strong>Chunking</strong> refers to loading the data in consecutive chunks, and doing something with each chunk. For example, we could load the rows 100 at a time, and sample 10 of them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sample from the first 100 rows</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Load 100 rows 20 times</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">new_sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">sample_df</span><span class="p">,</span> <span class="n">new_sample_df</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>37</th>
      <td>4</td>
      <td>Leandro Barbosa</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>107</td>
      <td>94</td>
      <td>114</td>
      <td>106</td>
      <td>14.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>1</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>62</th>
      <td>2</td>
      <td>Dwyane Wade</td>
      <td>0</td>
      <td>1</td>
      <td>MIA</td>
      <td>CHI</td>
      <td>17</td>
      <td>26</td>
      <td>66</td>
      <td>108</td>
      <td>44.666667</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>Amare Stoudemire</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>20</td>
      <td>33</td>
      <td>114</td>
      <td>106</td>
      <td>13.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1</td>
      <td>Kirk Hinrich</td>
      <td>0</td>
      <td>1</td>
      <td>MIA</td>
      <td>CHI</td>
      <td>10</td>
      <td>17</td>
      <td>66</td>
      <td>108</td>
      <td>18.866667</td>
      <td>2006</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(210, 13)
</pre></div>
</div>
</div>
</div>
<p>At the end of this notebook we’ll discuss a way to make this more efficient.</p>
</div>
<div class="section" id="setting-data-types-upon-loading-a-id-loading-dtypes-a">
<h3>Setting data types upon loading <a id="loading_dtypes"></a><a class="headerlink" href="#setting-data-types-upon-loading-a-id-loading-dtypes-a" title="Permalink to this headline">¶</a></h3>
<p>Now that you know how to load just a few rows at a time, you can examine your data to see what data types would work best to save as much memory as possible. So for instance, we see that all integer columns except scores could be loaded as <code class="docutils literal notranslate"><span class="pre">np.uint8</span></code>, and the scores as <code class="docutils literal notranslate"><span class="pre">np.uint16</span></code>. We can specify this upon loading by giving a dictionary with column names and data types to the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> argument in <code class="docutils literal notranslate"><span class="pre">.read_csv()</span></code>. Note that you don’t have to specify <em>every</em> columns data type. If you leave a column out, Pandas will just load it with what it thinks is best. So since it’s already correctly loading the player names, team names and minutes, we’ll leave those alone. We’ll just tell is to load the integers using smaller memory data types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtype_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="s1">&#39;playoffs&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="s1">&#39;shot_made&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="s1">&#39;home_score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">,</span> <span class="s1">&#39;visit_score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">,</span> <span class="s1">&#39;home_final_score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">,</span> 
             <span class="s1">&#39;visit_final_score&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">,</span> <span class="s1">&#39;season_start&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">,</span> <span class="s1">&#39;shot_count&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">}</span>

<span class="n">df_slim</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_size_mb</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">df_slim_size_mb</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_slim</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Original file memory usage: </span><span class="si">{</span><span class="n">df_size_mb</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> MB&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Slimmed file memory usage: </span><span class="si">{</span><span class="n">df_slim_size_mb</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> MB&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Reduction of </span><span class="si">{</span><span class="n">df_size_mb</span> <span class="o">/</span> <span class="n">df_slim_size_mb</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original file memory usage: 64.3 MB
Slimmed file memory usage: 28.4 MB
Reduction of 2.3x
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="timing-computations-a-id-timing-computations-a">
<h2>Timing computations <a id="timing_computations"></a><a class="headerlink" href="#timing-computations-a-id-timing-computations-a" title="Permalink to this headline">¶</a></h2>
<p>Up to this point we’ve focused on memory usage. Now, let’s turn our attention to processing time. When you first started this course you were probably struggling to just learn how to get your code to do what you want. But now that you know more you are likely able to accomplish lots of different tasks, often times in more than one way. Once you reach that point it’s good to start thinking about computational efficiency. Simple things like linear regression happen almost instantaneously, but more complex tasks like grid search cross validation using XGBoost can easily take hours, if not days to run. In addition, often you will run a long computation, only to realize that you should have done some things differently. Perhaps you picked a range of hyperparametrs to search, ran grid search for four hours, and the results came back that all the hyperparameters selected were the largest ones you let it search. Maybe that means you need to go larger! So you start grid search again with even larger hyperparameters, which means it will be running for even longer! In cases like these it is beneficial to try and speed up your code.</p>
<p>The first question to ask then is, how long does my code take to run? Python can help us with that! The simplest way, which is appropriate for anything which will take several seconds or longer (as opposed to milliseconds or nanoseconds, for which it won’t be as precise) is using the built-in Python library <code class="docutils literal notranslate"><span class="pre">time</span></code>, which we imported up top.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This is _not_ the most efficient way to check for primality, but that&#39;s okay for our purposes</span>
<span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="c1"># The percent operator &quot;%&quot; means &quot;modulo&quot;, so it&#39;s dividing by c and taking the remainder</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="c1"># If nothing divides it, return True</span>
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_prime</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">is_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Record when the computations start</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

<span class="c1"># Do your computations</span>
<span class="n">primes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">primes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">primes</span><span class="p">)</span><span class="si">}</span><span class="s1"> primes found&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">primes</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">% of the numbers between 2 and 10^5 are prime&#39;</span><span class="p">)</span>

<span class="c1"># Record when the computations end</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

<span class="c1"># Print out how long it took (the result is in seconds)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Elapsed time: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9592 primes found
9.59% of the numbers between 2 and 10^5 are prime
Elapsed time: 27.700 seconds
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="comprehensions-a-id-comprehensions-a">
<h2>Comprehensions <a id="comprehensions"></a><a class="headerlink" href="#comprehensions-a-id-comprehensions-a" title="Permalink to this headline">¶</a></h2>
<p>In the very first notebook of this semester we introduced list comprehensions. Recall that list comprehensions are lists (you can also do them with sets, dictionaries, and any iterable) that you create using the format <code class="docutils literal notranslate"><span class="pre">[f(a)</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">in</span> <span class="pre">blah]</span></code>. Why do we do this? Is it just to be fancy? Let’s time some operations to see how creating a list of primes this way compares to doing it using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Method 1 - for loop</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

<span class="n">squares</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">squares</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        
<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Elapsed time using a for loop: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed time using a for loop: 39.525 seconds
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Method 2 - list comprehension</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

<span class="n">squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">8</span><span class="p">)]</span>

<span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Elapsed time using a for loop: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> seconds&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Elapsed time using a for loop: 36.268 seconds
</pre></div>
</div>
</div>
</div>
<p>That’s about an 8% reduction (at least on my computer) in run time. While that may not seem like a lot, 8% of six hours is about half an hour saved. If you have multiple <code class="docutils literal notranslate"><span class="pre">for</span></code> loops in your code (or even worse, a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop inside another <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, called a “nested <code class="docutils literal notranslate"><span class="pre">for</span></code> loop”) then you are losing a lot of computation time.</p>
</div>
<div class="section" id="deleting-data-in-memory">
<h2>Deleting data in-memory<a class="headerlink" href="#deleting-data-in-memory" title="Permalink to this headline">¶</a></h2>
<p>Whenever you load data into your computer using <code class="docutils literal notranslate"><span class="pre">pd.read_csv()</span></code> it stays in memory. For example, Python is still holding the free throw data above in memory waiting for us to use it. However, sometimes you may load some data, look at it, keep a subset of it, and then want to throw away the rest. How do you tell Python that you no longer want it around? The answer is <code class="docutils literal notranslate"><span class="pre">del</span></code> (short for delete). Deleting data is as simple as <code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">my_data</span></code>. Let’s check it out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check to make sure the data is still in memory</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>period</th>
      <th>player</th>
      <th>playoffs</th>
      <th>shot_made</th>
      <th>home_team</th>
      <th>visit_team</th>
      <th>home_score</th>
      <th>visit_score</th>
      <th>home_final_score</th>
      <th>visit_final_score</th>
      <th>minutes</th>
      <th>season_start</th>
      <th>shot_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>1</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>2</td>
      <td>0</td>
      <td>114</td>
      <td>106</td>
      <td>47.000000</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>Andrew Bynum</td>
      <td>0</td>
      <td>0</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>18</td>
      <td>114</td>
      <td>106</td>
      <td>29.733333</td>
      <td>2006</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>Shawn Marion</td>
      <td>0</td>
      <td>1</td>
      <td>LAL</td>
      <td>PHX</td>
      <td>12</td>
      <td>21</td>
      <td>114</td>
      <td>106</td>
      <td>29.200000</td>
      <td>2006</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delete it</span>
<span class="k">del</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># It&#39;s no longer in memory</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">67</span><span class="o">-</span><span class="mi">0</span><span class="n">f3b9960aee0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># It&#39;s no longer in memory</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;df&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sklearn-warm-start-a-id-warm-start-a">
<h2>Sklearn warm start <a id="warm_start"></a><a class="headerlink" href="#sklearn-warm-start-a-id-warm-start-a" title="Permalink to this headline">¶</a></h2>
<p>Let’s suppose you had a large dataset that you couldn’t fit in memory. In that case, you decide to load the data in chunks and create a subset to train your model on. However, after looking at your data you realize that even your <em>subset</em> would be too large. What can you do about it? You may guess that you can load data, train your model, load more data, train your model again, and so forth, as such:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the first 5 groups of 1000 rows</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_chunks_to_load</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Instantiate the model</span>
<span class="n">xgb_reg</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">()</span>

<span class="c1"># Load data, train the model, repeat</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_chunks_to_load</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fitting model on rows </span><span class="si">{</span><span class="n">n_rows</span><span class="o">*</span><span class="n">i</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">n_rows</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_rows</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[[</span><span class="s1">&#39;shot_count&#39;</span><span class="p">,</span> <span class="s1">&#39;playoffs&#39;</span><span class="p">,</span> <span class="s1">&#39;minutes&#39;</span><span class="p">]]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;shot_made&#39;</span><span class="p">]</span>
    <span class="n">xgb_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting model on rows 0 to 1000
Fitting model on rows 1000 to 2000
Fitting model on rows 2000 to 3000
Fitting model on rows 3000 to 4000
Fitting model on rows 4000 to 5000
</pre></div>
</div>
</div>
</div>
<p>This code runs, and you may think everything has gone perfectly. However, what you’ve <em>actually</em> done is train a model <em>only on rows 4000 to 5000</em>. This is because every time you call <code class="docutils literal notranslate"><span class="pre">.fit()</span></code>, sklearn assumes you want to start fresh. So even if you already <code class="docutils literal notranslate"><span class="pre">.fit</span></code> your model on some other data, it assumes you no longer want that, and so it creates a new one and throws away the old one. What we want is to do a <em>warm start</em>. In model training, a <strong>warm start</strong> is when you take a model which was already trained on some data, and then train it on additional data <em>without discarding what it already learned</em>. It is incredibly simple to do. When you instantiate the model, simply set <code class="docutils literal notranslate"><span class="pre">warm_start=True</span></code>. We can copy and paste the above code with that one minor change, and it will work how we want it to.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the first 5 groups of 1000 rows</span>
<span class="n">n_rows</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">n_chunks_to_load</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Instantiate the model</span>
<span class="n">xgb_reg</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span><span class="n">warm_start</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># THIS IS THE ONLY CHANGE!</span>

<span class="c1"># Load data, train the model, repeat</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_chunks_to_load</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fitting model on rows </span><span class="si">{</span><span class="n">n_rows</span><span class="o">*</span><span class="n">i</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">n_rows</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drive_dir</span> <span class="o">+</span> <span class="s1">&#39;data/free_throws.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_rows</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[[</span><span class="s1">&#39;shot_count&#39;</span><span class="p">,</span> <span class="s1">&#39;playoffs&#39;</span><span class="p">,</span> <span class="s1">&#39;minutes&#39;</span><span class="p">]]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;shot_made&#39;</span><span class="p">]</span>
    <span class="n">xgb_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fitting model on rows 0 to 1000
Fitting model on rows 1000 to 2000
Fitting model on rows 2000 to 3000
Fitting model on rows 3000 to 4000
Fitting model on rows 4000 to 5000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="final-thoughts-a-id-final-thoughts-a">
<h2>Final thoughts <a id="final_thoughts"></a><a class="headerlink" href="#final-thoughts-a-id-final-thoughts-a" title="Permalink to this headline">¶</a></h2>
<p>Most large companies who hire data scientists or analysts have incredible amounts of data to work with. Early on as a data scientist I was told that I would be working with a “small” dataset that had “only” eighty million rows of data. When working with data of this size you have to think strategically. Simply trying to load the entire data on your computer at once will never work. Instead, start with a small subset of the data to get a feel for it. Then, start figuring out what subset of the data you want to work with. Is it fine to just load the first 100,000 rows? Or do you need to sample according to a date which is growing? Come up with your strategy, and then import a chunk of the data. From that data, sample what you want and set it aside. Then, delete the original data using <code class="docutils literal notranslate"><span class="pre">del</span></code>. Then, load the next chunk and repeat. Note that this is different from what we did earlier, in that we’re deleting the data we loaded originally. This is important, because otherwise we are just accumulating more and more data in memory, and we’re actually not being any more efficient than just loading the entire thing!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="ch_10.html" title="previous page">Ensemble tree models</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>